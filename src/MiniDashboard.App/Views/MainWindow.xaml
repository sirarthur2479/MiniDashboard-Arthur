<Window x:Class="MiniDashboard.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:MiniDashboard.App.ViewModels"
        Title="Mini Dashboard" Height="500" Width="800">

  <Window.DataContext>
    <vm:MainViewModel/>
  </Window.DataContext>

  <Grid Margin="10">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <!-- Search -->
      <RowDefinition Height="*"/>
      <!-- DataGrid -->
      <RowDefinition Height="Auto"/>
      <!-- Add new item -->
      <RowDefinition Height="Auto"/>
      <!-- CRUD + Loading/Error -->
    </Grid.RowDefinitions>

    <!-- Row 0: Search -->
    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
      <TextBox Width="250" Height="30" Margin="0,0,10,0"
               Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" />
      <Button Content="Search" Width="100"
              Command="{Binding SearchCommand}"
              x:Name="SearchButton"
              AutomationProperties.AutomationId="SearchButton"/>
    </StackPanel>

    <!-- Row 1: DataGrid -->
    <DataGrid Grid.Row="1"
              ItemsSource="{Binding Items}"
              SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
              AutoGenerateColumns="False"
              VirtualizingStackPanel.IsVirtualizing="False"
              Height="300">
      <DataGrid.Columns>
        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="Auto"/>
        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="2*"/>
        <DataGridTextColumn Header="Price" Binding="{Binding Price}" Width="Auto"/>
      </DataGrid.Columns>
    </DataGrid>

    <!-- Row 2: Add new item inputs -->
    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,10">
      <TextBox Width="150" Margin="0,0,10,0"
               Text="{Binding NewItemName, UpdateSourceTrigger=PropertyChanged}" 
               x:Name="NameBox"
               AutomationProperties.AutomationId="NewItemName"/>
      <TextBox Width="200" Margin="0,0,10,0"
               Text="{Binding NewItemDescription, UpdateSourceTrigger=PropertyChanged}" 
               x:Name="DescBox"
               AutomationProperties.AutomationId="NewItemDescription" />
      <TextBox Width="80" Margin="0,0,10,0"
               Text="{Binding NewItemPrice, UpdateSourceTrigger=PropertyChanged}" 
               x:Name="PriceBox"
               AutomationProperties.AutomationId="NewItemPrice" />
      <Button Content="Add" Width="80"
              Command="{Binding AddItemCommand}" 
              x:Name="AddButton"
              AutomationProperties.AutomationId="AddButton" />
    </StackPanel>

    <!-- Row 3: CRUD buttons + loading/error -->
    <StackPanel Grid.Row="3" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,0,0">
      <Button Content="Update" Width="80" Margin="0,0,5,0"
              Command="{Binding UpdateItemCommand}"
              IsEnabled="{Binding SelectedItem}"
              x:Name="UpdateButton"
              AutomationProperties.AutomationId="UpdateButton"/>
      <Button Content="Delete" Width="80"
              Command="{Binding DeleteItemCommand}"
              IsEnabled="{Binding SelectedItem}" 
              x:Name="DeleteButton"
              AutomationProperties.AutomationId="DeleteButton"/>

      <!-- Loading & Error messages -->
      <ProgressBar Width="150" Height="20" Margin="20,0,0,0"
                   IsIndeterminate="True"
                   Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}" />
      <TextBlock Text="{Binding ErrorMessage}" Foreground="Red" Margin="10,0,0,0"
                 Visibility="{Binding ErrorMessage, Converter={StaticResource NullToVisibilityConverter}}" />
    </StackPanel>

  </Grid>
</Window>
